# This symbol is outside the eudev if-block, so that we do not have
# a circular dependency in kconfig. Thus, we need the dummy symbol,
# below, to inform the user that the daemon has indeed been enabled.
config BR2_PACKAGE_EUDEV_DAEMON
	bool
	select BR2_PACKAGE_HAS_UDEV
	select BR2_PACKAGE_UTIL_LINUX
	select BR2_PACKAGE_UTIL_LINUX_LIBBLKID
	select BR2_PACKAGE_KMOD
	# We can select this has we're sure eudev is selected when we are.
	select BR2_PACKAGE_EUDEV_DAEMON_DUMMY

config BR2_PACKAGE_EUDEV
	bool "eudev"
	depends on !BR2_INIT_SYSTEMD
	depends on BR2_USE_MMU # uses fork() (for daemon) and dlfcn.h (for libudev)
	depends on BR2_USE_WCHAR # needs C99 compiler
	depends on !BR2_STATIC_LIBS # dlfcn.h
	help
	  eudev is a fork of systemd-udev with the goal of obtaining
	  better compatibility with existing software such as OpenRC and
	  Upstart, older kernels, various toolchains and anything else
	  required by users and various distributions.

	  This option only installs the libudev library. If you want /dev
	  to be managed with the udev daemon, see "/dev management" in the
	  top-level menu "System configuration".

	  https://wiki.gentoo.org/wiki/Project:Eudev

if BR2_PACKAGE_EUDEV

comment "udev daemon needs eudev /dev management"
	depends on !BR2_ROOTFS_DEVICE_CREATION_DYNAMIC_EUDEV

# See comment at top of file.
config BR2_PACKAGE_EUDEV_DAEMON_DUMMY
	bool "udev daemon"
	depends on BR2_ROOTFS_DEVICE_CREATION_DYNAMIC_EUDEV
	help
	  Install the udev daemon.

# Use the dummy symbol for proper indentation
if BR2_PACKAGE_EUDEV_DAEMON_DUMMY

config BR2_PACKAGE_PROVIDES_UDEV
	default "eudev"

config BR2_PACKAGE_EUDEV_RULES_GEN
	bool "enable rules generator"
	help
	  Enable persistent rules generator

config BR2_PACKAGE_EUDEV_ENABLE_HWDB
	bool "enable hwdb installation"
	default y
	help
	  Enables hardware database installation to /etc/udev/hwdb.d

endif # BR2_PACKAGE_EUDEV_DAEMON

endif # BR2_PACKAGE_EUDEV

comment "eudev needs a toolchain w/ wchar, dynamic library"
	depends on BR2_USE_MMU
	depends on !BR2_INIT_SYSTEMD
	depends on !BR2_USE_WCHAR || BR2_STATIC_LIBS

comment "eudev incompatible with systemd init"
	depends on BR2_USE_MMU
	depends on BR2_INIT_SYSTEMD
	depends on BR2_USE_WCHAR && !BR2_STATIC_LIBS
